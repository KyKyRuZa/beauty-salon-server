# Beauty Vite - Модульная монолитная архитектура для платформы beauty services

## Описание

Beauty Vite - это модульная монолитная архитектура для платформы beauty services, предоставляющая возможности для управления салонами красоты, записью клиентов, управлением услугами и мастерами.

## Архитектура

Проект разделен на следующие модули:

- **user** - управление пользователями (клиенты, мастера, салоны)
- **admin** - административная панель
- **catalog** - каталог услуг
- **booking** - система бронирования
- **chat** - чат-функциональность

## Технологии

- **Backend**: Node.js, Express.js
- **База данных**: PostgreSQL 17.7
- **ORM**: Sequelize
- **Аутентификация**: JWT, bcrypt
- **Валидация**: Zod
- **Логирование**: Winston
- **Контейнеризация**: Docker, Docker Compose
- **Пул соединений**: PgBouncer

## Установка и запуск

### Локальный запуск

1. Установите зависимости:
```bash
npm install
```

2. Настройте переменные окружения в файле `.env`

3. Запустите приложение:
```bash
npm start
```

### Запуск в Docker

1. Убедитесь, что Docker и Docker Compose установлены

2. Запустите все сервисы:
```bash
npm run docker-up
```

Или используйте Docker Compose напрямую:
```bash
docker compose up -d
```

Приложение будет доступно по адресу: http://localhost:5000

## Docker-окружение

### Компоненты

- **PostgreSQL 17.7** - основная база данных
- **PgBouncer** - пул соединений к базе данных
- **Node.js** - приложение
- **Redis** (временно отключен) - кэш и сессии

### Порты

- 5000: веб-приложение
- 5433: PostgreSQL (внутри контейнера 5432)
- 6432: PgBouncer

## Система валидации

Проект использует Zod для валидации входящих данных. Все API-эндпоинты защищены валидацией, и ошибки возвращаются в унифицированном формате.

### Основные схемы валидации

- **Аутентификация**: регистрация, вход, обновление профиля
- **Пользователи**: клиенты, мастера, салоны
- **Каталог услуг**: категории, подкатегории, шаблоны услуг
- **Бронирование**: бронирования, заказы, доступность
- **Администраторы**: управление администраторами и категориями

## API

### Основные эндпоинты

- `/api/auth/register` - регистрация пользователя
- `/api/auth/login` - вход пользователя
- `/api/auth/profile` - получение профиля
- `/api/auth/edit-profile` - редактирование профиля
- `/api/auth/admin/register` - регистрация администратора
- `/api/auth/admin/login` - вход администратора
- `/api/catalog/` - каталог услуг
- `/api/booking/` - бронирование

## Безопасность

- JWT-токены для аутентификации
- Хэширование паролей с bcrypt
- Валидация входных данных с Zod
- Проверка ролей пользователей
- PgBouncer для управления соединениями с базой данных

## Тестирование

Для заполнения базы данных тестовыми данными используйте:
```bash
npm run seed
```

## Структура проекта

```
src/
├── app.js              # Основное приложение Express
├── server.js           # Запуск сервера
├── config/             # Конфигурация приложения
├── middleware/         # Middleware (аутентификация, валидация)
├── modules/            # Модули приложения
│   ├── admin/          # Административная часть
│   ├── booking/        # Бронирование
│   ├── catalog/        # Каталог услуг
│   ├── chat/           # Чат
│   └── user/           # Пользователи
├── validation/         # Схемы валидации Zod
└── utils/              # Вспомогательные утилиты
```

## Скрипты

- `npm start` - запуск приложения
- `npm run dev` - запуск в режиме разработки
- `npm run seed` - заполнение базы данных тестовыми данными
- `npm run docker-up` - запуск в Docker
- `npm run docker-down` - остановка Docker-контейнеров
- `npm run docker-build` - сборка Docker-образа

---

**Последнее обновление**: 12 февраля 2026 г.